\documentclass[11pt]{amsart}
\usepackage{amsmath}
\usepackage{geometry}                % See geometry.pdf to learn the layout options. There are lots.
\geometry{letterpaper}                   % ... or a4paper or a5paper or ... 
%\geometry{landscape}                % Activate for for rotated page geometry
%\usepackage[parfill]{parskip}    % Activate to begin paragraphs with an empty line rather than an indent
\usepackage{graphicx}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{amssymb}
\usepackage{epstopdf}
\usepackage[]{algorithm2e}
\usepackage{tikz}
\usetikzlibrary{positioning}
\usepackage{intcalc}
\usepackage{blkarray}

\title{Comp 652: Assignment 3}
\author{Carlos G. Oliver}
\date{\today}                                           % Activate to display a given date or no date

\begin{document}
\maketitle

\section{Q1: PCA}

\section{Q2: Spectral methods for weighted automata}
\subsection{(a)}

We use a property of Hankel matrices which is: if $\text{rank}(H_f) = n \Rightarrow$ there exists a weighted finite automaton $\mathcal{A}$  with $n$ states such that $g = g_{\mathcal{A}}$ for some function $g : \Sigma^{*} \rightarrow \mathbb{R}$ where $\Sigma^{*}$ is the set of all strings that can be generated from alphabet $\Sigma$. In this example, the function $g$ counts the number of $1$s in a string generated from $\Sigma = \{0, 1\}$ the Hankel matrix $H_g$ would take the form: 


 
\[
H_g = \begin{blockarray}{cccccc}
\def\ra{\color{red}\ba}
 & \lambda & 0 & 1 & 11 & \hdots \\
\begin{block}{c[ccccc]}
  \lambda & 0 & 0 & 1 & 2 & \hdots \\
  0 & 0 & 0 & 1 & 2 &  \\
  1 & 1 & 1 & 2 & 3 &  \\
  11 & 2 & 2 & 3 & 4 &  \\
  111 & 3 & 3 & 4 & 5 &  \\
  110 & 2 & 2 & 3 & 4 &  \\
  \vdots & \vdots &  &  &  & \ddots \\
\end{block}
\end{blockarray}
\label{mat:h_1}
 \]

The above matrix is arranged so all possible strings composed only of $1$s, $Q = \{1\}^N \quad \forall N \in \mathcal{Z}$ precede all other strings ($\Sigma^{*} - Q$) with the exception of $\{0\}^1$ and $\lambda$. If we order prefixes and suffixes in S in increasing $N$ we can easily see that any row $m$ in this sub block $H^{1}_g$ of $H_g$ is a linear combination in the form $H^{1}_g(m, \cdot) = 2H^{1}_g(m, \cdot) - H^{1}_g(m-1, \cdot)$. The remaining entries in $H_g$ are formed by prefixes and suffixes containing $0$s which do not contribute to the evaluation of $g$ and therefore can also be obtained from rows or columns in $H^{1}$. Therefore the rank of $H_g$ is 2 where only the $\lambda$ or $\{0\}^1$ and the $\{1\}^1$ contribute to the row rank. The same can be shown for the column rank.

\subsection{(b)}

If $f$ is a probability distribution over $\Sigma^*$ then we have $\sum_{s \in \Sigma^*} f(s) = 1$ gives a probability for every string in $\Sigma^*$. Then $f_{sub}(w)$ is the probability that the string $w$ occurs in any word generated by $\Sigma^*$ since $u$ and $v$ represent all possible prefixes and suffixes to the word $w$.

\subsection{(c)}

Let $ \Sigma_{w \in \Sigma^*} A_w \equiv S$.

\begin{equation}
\begin{aligned}
S = (I - A_0 - A_1)^{-1} = (I - A_0 - A_1) S          &= I \\
				       (I - A_0 - A_1)SS^{-1} &= S^{-1}	\\
				       (I - A_0 - A_1)^{-1} 	&= S
\end{aligned}
\end{equation}

Now we use this identity to compute the sum of the function $f$ over all words as $ \Sigma_{w \in \Sigma^*} f(w)$. We can express the function over a string as

\begin{equation}
\begin{aligned}
f(w) = \alpha_0 Aw \alpha_{\infty}
\end{aligned}
\end{equation}

So for all the words we have
\begin{equation}
\begin{aligned}
\sum_{w \in \Sigma^*} f(w) &= \sum_{w \in \Sigma^*} \alpha_0 A_w \alpha_{\infty} \\
					 &= \alpha_0 \bigg( \sum_{w \in \Sigma^*}  A_w  \bigg) \alpha_{\infty} \\
					 &= \alpha_0 (I - A_0 - A_1)^{-1} \alpha_{\infty}
\end{aligned}
\end{equation}

\end{document}  